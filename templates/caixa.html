{% extends "layout.html" %}

{% block title %}Controle de Caixa - Sistema PDV{% endblock %}

{% block main_content %}
<div class="page-container">
    <div class="page-header">
        <h1>Controle de Caixa</h1>
        <div class="header-actions">
            <button onclick="openTransactionModal()" class="btn btn-primary">Nova Transação</button>
            <div class="cash-balance-display">
                Saldo: <strong id="current-balance">R$ 0,00</strong>
            </div>
        </div>
    </div>
    
    <div class="cash-grid">
        <div class="cash-card success">
            <h3>Entradas</h3>
            <p class="cash-value" id="total-entries">R$ 0,00</p>
        </div>
        
        <div class="cash-card danger">
            <h3>Saídas</h3>
            <p class="cash-value" id="total-exits">R$ 0,00</p>
        </div>
    </div>
    
    <div class="filter-section">
        <input type="date" id="filter-date">
        <button onclick="filterTransactions()" class="btn btn-secondary">Filtrar</button>
        <button onclick="clearFilter()" class="btn btn-secondary">Limpar</button>
    </div>
    
    <table class="data-table">
        <thead>
            <tr>
                <th>Data</th>
                <th>Tipo</th>
                <th>Categoria</th>
                <th>Descrição</th>
                <th>Valor</th>
            </tr>
        </thead>
        <tbody id="transactions-table"></tbody>
    </table>
</div>

<div id="transaction-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Nova Transação</h2>
            <button onclick="closeTransactionModal()" class="close-btn">&times;</button>
        </div>
        
        <form id="transaction-form">
            <div class="form-group">
                <label>Tipo *</label>
                <select id="transaction-type" required>
                    <option value="opening">Abertura de Caixa</option>
                    <option value="entry">Entrada</option>
                    <option value="exit">Saída</option>
                    <option value="closing">Fechamento de Caixa</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Categoria</label>
                <select id="transaction-category">
                    <option value="">Selecione...</option>
                    <option value="fuel">Combustível</option>
                    <option value="supplies">Suprimentos</option>
                    <option value="sales">Vendas</option>
                    <option value="other">Outro</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Valor *</label>
                <input type="number" id="transaction-amount" step="0.01" required>
            </div>
            
            <div class="form-group">
                <label>Descrição</label>
                <textarea id="transaction-description" rows="3"></textarea>
            </div>
            
            <div class="modal-actions">
                <button type="submit" class="btn btn-primary">Salvar</button>
                <button type="button" onclick="closeTransactionModal()" class="btn btn-secondary">Cancelar</button>
            </div>
        </form>
    </div>
</div>

<script src="{{ url_for('static', filename='js/caixa.js') }}"></script>
{% endblock %}
